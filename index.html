<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>勝手に統計力学入門</title>
    <style>
      body {
        font-family: 'Segoe UI', 'Meiryo', 'Yu Gothic', sans-serif;
        line-height: 1.8;
        margin: 20px auto; /* 上下の余白を調整、左右はautoで中央寄せ */
        max-width: 900px; /* PC表示時の最大横幅を900pxに設定 */
        color: #333;
        background-color: #f9f9f9;
        padding: 0 15px; /* 左右の余白を確保 */
        box-sizing: border-box; /* paddingがwidthに含まれるように */
      }
      h1 {
        font-size: 2.3em;
        color: #0056b3;
        border-bottom: 2px solid #0056b3;
        padding-bottom: 10px;
        margin-top: 50px;
        text-align: center;
      }
      h2 {
        font-size: 1.9em;
        color: #0056b3;
        border-bottom: 1px solid #a7d9f7;
        padding-bottom: 8px;
        margin-top: 40px;
      }
      h3 {
        font-size: 1.6em;
        color: #0056b3;
        margin-top: 30px;
      }
      h4 {
        font-size: 1.3em;
        color: #0056b3;
        margin-top: 25px;
      }
      p {
        margin-bottom: 1em;
        font-size: 1.05em;
        text-align: justify;
      }
      strong {
        color: #d9534f; /* 強調色 */
      }
      em {
        color: #5cb85c; /* 重要な専門用語 */
        font-style: normal;
      }
      ul {
        list-style-type: disc;
        margin-left: 25px;
        margin-bottom: 1em;
      }
      li {
        margin-bottom: 0.5em;
        font-size: 1.05em;
      }
      code {
        background-color: #eef;
        padding: 2px 4px;
        border-radius: 4px;
        font-family: 'Consolas', 'Monaco', monospace;
        color: #c7254e;
      }
      pre {
        background-color: #eef;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        font-size: 0.95em;
        line-height: 1.5;
        color: #c7254e;
      }
      .section-intro {
        background-color: #e0f7fa;
        border-left: 5px solid #00acc1;
        padding: 20px;
        margin: 30px 0;
        border-radius: 5px;
        font-size: 1.1em;
      }
      .exercise {
        background-color: #f0f0f0;
        border-left: 4px solid #f0ad4e;
        padding: 15px;
        margin: 25px 0;
        border-radius: 5px;
      }
      .solution {
        background-color: #e9f7ef;
        border-left: 4px solid #5cb85c;
        padding: 15px;
        margin: 25px 0;
        border-radius: 5px;
      }
      .important-point {
        background-color: #fffacd;
        border-left: 4px solid #ffcc00;
        padding: 10px;
        margin: 20px 0;
        border-radius: 5px;
        font-weight: bold;
      }
      .math-eq {
        font-family: 'Times New Roman', serif;
        font-style: italic;
        display: block;
        margin: 1em 0;
        text-align: center;
        font-size: 1.1em;
      }
      /* Media Queries for smaller screens (smartphones) */
      @media (max-width: 768px) {
        body {
          margin: 15px auto;
          padding: 0 10px;
          /* スマートフォンではmax-widthよりもviewportの幅が小さくなるため、
                   自動的にコンテンツが画面幅いっぱいに広がります。 */
        }
        h1 {
          font-size: 1.9em;
        }
        h2 {
          font-size: 1.6em;
        }
        h3 {
          font-size: 1.4em;
        }
        h4 {
          font-size: 1.15em;
        }
        p,
        li,
        .section-intro,
        .exercise,
        .solution {
          font-size: 0.98em; /* スマートフォンでの文字サイズを微調整 */
        }
      }
    </style>
  </head>
  <body>
    <h1>勝手に統計力学入門</h1>

    <div class="section-intro">
      <p>
        このドキュメントは、大学の熱力学・統計力学の授業で配布されるPDFの内容を、より分かりやすく、かつ実践的に理解できるように再構成したものです。特に、公式がなぜ必要とされたかの歴史的背景を簡潔に紹介し、概念の導入と導出をより段階的に、初心者の方にもスムーズに理解できるよう工夫しました。公式の導出、例題、演習問題とその解答を網羅し、各概念がどのように応用されるかを重点的に解説します。
      </p>
    </div>

    <h2>第9回：気体の分子運動論とマクスウェルの速度分布</h2>

    <h3>9.1 気体の分子運動論</h3>
    <p>
      私たちは普段、気体を「目に見えないもの」として捉えています。しかし、気体がなぜ圧力を生じさせたり、温度によって膨張したりするのかを理解するためには、その内部で何が起こっているのかを想像する必要があります。気体の分子運動論は、まさにこの「想像」を科学的に裏付け、<strong>圧力や温度といった巨視的な現象が、無数の分子の微視的な運動によってどのように引き起こされるのか</strong>を説明するための理論として発展しました。
    </p>
    <p>
      17世紀から18世紀にかけて、ボイル、シャルル、ゲイ=リュサックといった科学者たちが、気体の巨視的な振る舞い（圧力、体積、温度の関係）に関する法則を発見しました。これらの法則は実験によって確認されましたが、なぜそうなるのかという根本的な理由は不明でした。そこで、彼らの時代にはまだ確証がなかった「原子や分子」という概念を導入し、その運動に着目することで、これらの巨視的な法則を微視的な視点から説明しようとする試みが始まりました。これが気体の分子運動論の始まりです。
    </p>
    <p>
      この理論は、私たちの目には見えない分子一つ一つの動きを仮定することで、目に見える気体の性質を論理的に説明しようとします。
    </p>

    <h4>理想気体の仮定</h4>
    <p>
      気体の分子運動論では、話を単純化するために「理想気体」という架空の気体を考えます。これは、以下の理想的な条件を満たす気体です:
    </p>
    <ul>
      <li><strong>分子の大きさは無視できる</strong>: 分子の体積が、気体全体の体積に比べて非常に小さいと仮定します。</li>
      <li>
        <strong>分子は互いに力を及ぼし合わない</strong>:
        分子同士の間に働く力（引力や斥力）は、衝突している瞬間以外は存在しないとします。
      </li>
      <li>
        <strong>分子は常に不規則に運動している</strong>:
        分子は容器の壁や他の分子と衝突しながら、ランダムな方向に動き回っています。
      </li>
      <li>
        <strong>衝突は弾性的である</strong>:
        分子同士の衝突や、分子と容器の壁との衝突では、運動エネルギーが失われない（完全弾性衝突）と仮定します。
      </li>
      <li>
        <strong>すべての分子は同じ種類である</strong>: 混合気体ではなく、単一の種類の分子から構成されているとします。
      </li>
      <li><strong>気体は容器の壁と熱平衡にある</strong>: 気体全体の温度が均一であることを意味します。</li>
    </ul>
    <p>
      これらの仮定を用いることで、複雑な現実の気体をシンプルなモデルで扱い、その性質を数学的に記述することが可能になります。
    </p>

    <h4>理想気体の圧力の導出</h4>
    <p>さて、分子が壁に衝突することで圧力が生じるという考え方に基づいて、圧力を数学的に導出してみましょう。</p>
    <p>
      体積 $V$ の直方体の容器の中に、多数の理想気体分子が閉じ込められていると想像してください。それぞれの分子は質量 $m$
      を持ち、様々な速度で動き回っています。ある分子がX方向の壁に衝突し、跳ね返される状況を考えます。
    </p>
    <ol>
      <li>
        <strong>壁に与える運動量（力積）</strong>: 分子が壁に衝突する前、そのX方向の速度成分を $u$
        とします。弾性衝突なので、衝突後は速度が反転し $-u$ となります。 分子の運動量の変化は $(-mu) - (mu) = -2mu$
        です。 <strong>作用・反作用の法則</strong>により、分子が壁から受ける運動量（力積）は $-2mu$ であり、<strong
          >壁が分子から受ける運動量（力積）はその反作用で $2mu$</strong
        >
        となります。この運動量の変化が、壁に与える「力」の源となります。
      </li>
      <li>
        <strong>1秒間に壁に衝突する回数</strong>: 容器のX方向の長さを $l$ とします。X方向の速度 $u$
        の分子は、壁に衝突してから反対側の壁に到達し、また元の壁に戻ってくるまでに $2l/u$ の時間がかかります。
        したがって、1秒間にその壁に衝突する回数は $u/(2l)$ となります。 容器の底面積を $S$ とすると、$V=Sl$
        なので、$l=V/S$ です。これを代入すると、衝突回数は $\frac{u}{2(V/S)} = \frac{uS}{2V}$ と表せます。
      </li>
      <li>
        <strong>1秒間に壁に及ぼす全体の力積（圧力）</strong>:
        すべての分子が同じ速度を持っているわけではありません。速度が $u$ から $u+du$ の間にある分子の数を $dN_u$
        とします。 これらの分子が1秒間に壁に及ぼす力積は、$dN_u \cdot 2mu \cdot \frac{uS}{2V} = \frac{N_0 m}{V} u^2 f(u)
        du S$ となります（ここで $N_0$ は全分子数、 $f(u)du$ は速度が $u \sim u+du$
        の分子の割合を表す確率密度関数です）。
        <p>
          圧力 $P$ は、単位面積あたりの力積（力）なので、全体の分子が壁に及ぼす力積を面積 $S$
          で割ったものになります。そして、すべての速度成分を持つ分子からの寄与を足し合わせる（積分する）と、圧力 $P$
          は以下のようになります。
        </p>
        <p class="math-eq">
          $P = \frac{1}{S} \int_{all u} \frac{N_0 m}{V} u^2 f(u) du S = \frac{N_0 m}{V} \int u^2 f(u) du = \frac{N_0
          m}{V} \overline{u^2}$
        </p>
        <p>ここで $\overline{u^2}$ は、分子のX方向速度成分の二乗平均です。</p>
        <p>
          気体分子はランダムに動き回っており、X, Y,
          Z方向は空間的に等価であるため、それぞれの方向の速度成分の二乗平均は等しくなります。
        </p>
        <p class="math-eq">$\overline{u^2} = \overline{v^2} = \overline{w^2}$</p>
        <p>
          また、分子の速さ $\nu$ は $\nu^2 = u^2 + v^2 + w^2$ で定義されるため、その二乗平均は $\overline{\nu^2} =
          \overline{u^2} + \overline{v^2} + \overline{w^2} = 3\overline{u^2}$ となります。
        </p>
        <p>
          したがって、$\overline{u^2} = \frac{1}{3}\overline{\nu^2}$
          となり、これを上記の圧力の式に代入すると、最終的な圧力の式が得られます。
        </p>
        <p class="math-eq">$P = \frac{1}{3} \frac{N_0 m \overline{\nu^2}}{V}$</p>
      </li>
    </ol>
    <p>
      この式は、気体の圧力が、分子の質量、数、そして分子の速さの二乗平均（つまり運動エネルギー）に依存することを示しています。
    </p>

    <h4>温度の分子論的な解釈</h4>
    <p>
      熱力学では、理想気体の状態方程式として $PV=RT$（$R$
      は気体定数）という経験則が知られています。これは、圧力、体積、温度という巨視的な物理量の間には常にこの関係が成り立つことを示しています。
    </p>
    <p>
      ここで、私たちが導出した圧力の式 $P = \frac{1}{3} \frac{N_0 m \overline{\nu^2}}{V}$
      を、理想気体の状態方程式に代入してみましょう。
    </p>
    <p class="math-eq">$\left(\frac{1}{3} \frac{N_0 m \overline{\nu^2}}{V}\right) V = RT$</p>
    <p class="math-eq">$\frac{1}{3} N_0 m \overline{\nu^2} = RT$</p>
    <p>この式を、分子1個あたりの運動エネルギー $\frac{1}{2}m\overline{\nu^2}$ の形に変形してみます。</p>
    <p class="math-eq">$N_0 \left(\frac{1}{3} m \overline{\nu^2}\right) = RT$</p>
    <p class="math-eq">$N_0 \cdot \frac{2}{3} \left(\frac{1}{2} m \overline{\nu^2}\right) = RT$</p>
    <p class="math-eq">$\frac{1}{2} m \overline{\nu^2} = \frac{3}{2} \frac{R}{N_0} T$</p>
    <p>
      ここで、新しい定数 $k_B = \frac{R}{N_0}$ を導入します。この $k_B$
      を<strong>ボルツマン定数</strong>と呼びます。ボルツマン定数は、気体定数 $R$ をアボガドロ定数 $N_0$
      で割ったものであり、分子1個あたりの気体定数と考えることができます。
    </p>
    <p>このボルツマン定数を使うと、上記の式は非常にシンプルになります。</p>
    <p class="math-eq">$\frac{1}{2}m\overline{\nu^2} = \frac{3}{2}k_B T$</p>
    <p class="important-point">
      この式は、気体分子運動論における最も重要な結論の一つです。それは、<strong
        >気体分子1個あたりの平均運動エネルギーが、絶対温度 $T$ に比例する</strong
      >ということを示しています。つまり、温度が高いほど分子は速く動き、運動エネルギーが大きいということになります。これは、私たちが経験的に知っている「熱いものは分子の動きが激しい」という直感を、数学的に裏付けたものと言えます。温度という巨視的な概念が、分子の微視的な運動エネルギーと直結していることが明らかになりました。
    </p>

    <h4>エネルギー等分配の法則</h4>
    <p>
      上記の式 $\frac{1}{2}m\overline{\nu^2} = \frac{3}{2}k_B T$
      は、単原子分子（例えばヘリウムやネオン）の場合に特に重要です。単原子分子は、並進運動（空間を移動する運動）の3つの自由度（X、Y、Z方向の運動）しか持ちません。
    </p>
    <p>
      <strong>エネルギー等分配の法則</strong>とは、古典統計力学の重要な法則で、<strong
        >熱平衡状態にある系では、運動エネルギーの二次形式（例えば $\frac{1}{2}mv^2$
        のように速度の二乗に比例する項）で表される自由度1つあたり、平均して $\frac{1}{2}k_B T$
        のエネルギーが分配される</strong
      >というものです。 単原子分子は3つの並進自由度を持つため、それぞれの自由度に対して $\frac{1}{2}k_B T$
      のエネルギーが分配され、合計で $3 \times \frac{1}{2}k_B T = \frac{3}{2}k_B T$
      の平均運動エネルギーを持つことになります。この法則は、分子運動論と熱力学を結びつける強力な概念です。
    </p>

    <div class="exercise">
      <h4>演習問題 9.1</h4>
      <p>
        温度 $T$ の理想気体中の分子の二乗平均速度 $\overline{\nu^2}$ を、ボルツマン定数 $k_B$、分子質量 $m$
        を用いて表せ。
      </p>
    </div>
    <div class="solution">
      <h4>解答 9.1</h4>
      <p>
        上記の「温度の分子論的な解釈」の導出より、気体分子1個当たりの平均運動エネルギーは、温度 $T$
        と以下の関係式で与えられます。
      </p>
      <p class="math-eq">$\frac{1}{2}m\overline{\nu^2} = \frac{3}{2}k_B T$</p>
      <p>この式を、分子の二乗平均速度 $\overline{\nu^2}$ について解きます。両辺を $m$ で割り、2を掛けると、</p>
      <p class="math-eq">$\overline{\nu^2} = \frac{3k_B T}{m}$</p>
      <p>となります。この式から、温度が高いほど、また分子の質量が小さいほど、分子の動きが速くなることがわかります。</p>
    </div>

    <h2>第10回：古典統計力学の破綻と統計集団の概念</h2>

    <h3>10.2 古典統計力学の破綻</h3>
    <p>
      前回の講義で学んだように、気体の分子運動論は、理想気体の性質を非常にうまく説明できました。しかし、科学が進歩し、より精密な実験が行われるようになると、古典的な物理学（ニュートン力学と古典統計力学）だけでは説明できない現象がいくつか現れてきました。これらの現象は、古典統計力学の限界を示し、新しい物理学の必要性、すなわち「量子論」の登場を促すことになります。これが<strong>古典統計力学の破綻</strong>と呼ばれるものです。
    </p>
    <p>具体的にどのような問題が生じたのでしょうか？</p>
    <ul>
      <li>
        <strong>固体の比熱の問題（デュロン=プティの法則の限界）</strong>:
        古典統計力学とエネルギー等分配の法則を固体に適用すると、「固体の定積モル比熱は常温付近で常に約 $3R$ （$R$
        は気体定数）となる」という<strong>デュロン=プティの法則</strong>が導かれます。これは高温では実験とよく一致しますが、<strong>低温になると固体の比熱は急速に減少</strong>し、ゼロに近づくという実験結果が得られました。古典論では、温度が下がっても比熱が一定のままになると予測されるため、この低温での挙動を説明できませんでした。
      </li>
      <li>
        <strong>空洞輻射（黒体輻射）の問題と紫外破綻</strong>:
        熱せられた物体から放射される電磁波（熱輻射）の性質を研究することは、19世紀末の物理学の大きな課題でした。特に、あらゆる波長の電磁波を完全に吸収・放出する理想的な物体「黒体」からの輻射（空洞輻射）は、そのスペクトル（波長ごとの強さの分布）が温度のみに依存するという重要な性質を持っていました。
        古典的な物理学（レイリー・ジーンズの法則）を用いて黒体輻射のスペクトルを計算すると、<strong>短い波長の光（紫外線領域）でエネルギーが無限大に発散してしまう</strong>という恐ろしい結果が得られました。これを「<strong
          >紫外破綻（Ultraviolet Catastrophe）</strong
        >」と呼びます。実験結果は、短い波長では輻射強度が減少していくことを示しており、古典論との間に大きな矛盾が生じました。
      </li>
    </ul>
    <p>
      これらの問題は、原子や分子、そして光といったミクロな世界のエネルギーが、連続的な値をとるのではなく、ある最小単位（量子）の整数倍の値しかとれない、という「エネルギーの量子化」という新しい概念を導入することで、初めて解決されました。この新しい概念こそが、20世紀の幕開けとともに発展する量子論の基礎となります。
    </p>

    <h3>10.3 正準形式（ハミルトン形式）</h3>
    <p>
      古典統計力学の限界を見た後で、少し古典力学の概念に戻ります。物理現象を記述する方法は、ニュートンの運動方程式だけではありません。18世紀にラグランジュ、そして19世紀にハミルトンによって導入された「正準形式（ハミルトン形式）」は、運動方程式をより抽象的で強力な形で記述する方法であり、統計力学や量子力学を学ぶ上で不可欠な概念です。
    </p>
    <p>
      ニュートン力学では「力」と「加速度」の関係で運動を記述しましたが、正準形式では系の「エネルギー」に着目します。
    </p>
    <ul>
      <li>
        <strong>ハミルトニアン $H$</strong>: ハミルトニアン $H$ は、系の全エネルギーを表す関数で、<strong
          >一般化座標 $q_i$ と一般化運動量 $p_i$ を独立な変数</strong
        >として表現されます。 通常の運動エネルギーが $\frac{1}{2}m\dot{x}^2$
        （速度の関数）であるのに対し、ハミルトニアンでは運動量 $p = m\dot{x}$ を使って $\frac{p^2}{2m}$
        （運動量の関数）と表されます。
        <p class="math-eq">$H(q_1, \dots, q_n, p_1, \dots, p_n)$</p>
      </li>
      <li>
        <strong>正準方程式</strong>: ハミルトニアンを用いると、系の時間発展は以下の2つのシンプルな方程式で記述されます。
        <p class="math-eq">$\dot{q_i} = \frac{\partial H}{\partial p_i}$</p>
        <p class="math-eq">$\dot{p_i} = -\frac{\partial H}{\partial q_i}$</p>
        <p>
          これらの式は、一見すると抽象的に見えますが、実はニュートンの運動方程式と全く同じ内容を表現しています。この形式で運動を記述することの利点は、座標変換などに対してより柔軟であり、特に統計力学で多数の粒子の振る舞いを扱う際に、数学的な取り扱いが非常に容易になる点にあります。
        </p>
      </li>
    </ul>

    <div class="exercise">
      <h4>演習問題 10.1</h4>
      <p>
        1次元空間を運動する質量 $m$ の自由粒子（ポテンシャルエネルギー
        $U=0$）のハミルトニアンを書き、正準方程式を導出せよ。
      </p>
    </div>
    <div class="solution">
      <h4>解答 10.1</h4>
      <p>
        1次元空間を運動する自由粒子の運動エネルギー $T$ は、速度 $\dot{q}$ を用いて $T = \frac{1}{2}m\dot{q}^2$
        と表せます。
      </p>
      <p>一般化運動量 $p$ は $p = m\dot{q}$ なので、$\dot{q} = \frac{p}{m}$ となります。</p>
      <p>
        これを運動エネルギーの式に代入すると、$T = \frac{1}{2}m\left(\frac{p}{m}\right)^2 = \frac{1}{2}m\frac{p^2}{m^2}
        = \frac{p^2}{2m}$ となります。
      </p>
      <p>自由粒子なのでポテンシャルエネルギー $U=0$ です。</p>
      <p>ハミルトニアン $H$ は、運動エネルギー $T$ とポテンシャルエネルギー $U$ の和なので、$H = T + U$ です。</p>
      <p>したがって、自由粒子のハミルトニアンは以下のようになります。</p>
      <p class="math-eq">$H(q, p) = \frac{p^2}{2m}$</p>
      <p>次に、正準方程式を導出します。</p>
      <ol>
        <li>
          $\dot{q} = \frac{\partial H}{\partial p}$
          <p>
            $H = \frac{p^2}{2m}$ を $p$ で偏微分すると、$\frac{\partial}{\partial p} \left(\frac{p^2}{2m}\right) =
            \frac{2p}{2m} = \frac{p}{m}$
          </p>
          <p>よって、$\dot{q} = \frac{p}{m}$。これは、$p=m\dot{q}$ という運動量の定義そのものを示しています。</p>
        </li>
        <li>
          $\dot{p} = -\frac{\partial H}{\partial q}$
          <p>
            $H = \frac{p^2}{2m}$ を $q$ で偏微分すると、ハミルトニアンは $q$ を含まないので、$\frac{\partial}{\partial
            q} \left(\frac{p^2}{2m}\right) = 0$
          </p>
          <p>
            よって、$\dot{p} = 0$。これは、運動量 $p$
            が時間的に変化しない（保存される）ことを意味しており、力が働かない自由粒子の運動と完全に一致します。
          </p>
        </li>
      </ol>
    </div>

    <div class="exercise">
      <h4>レポート問題 10.1</h4>
      <p>
        重力加速度 $g$ の一様重力場中を自由落下する質量 $m$ の粒子について、座標を $q$、運動量を $p$
        として正準方程式を求めよ（1次元空間での運動を考えよ）。また、正準方程式を解き、$q$ を $p$ の関数として表せ。
      </p>
    </div>
    <div class="solution">
      <h4>解答 10.1</h4>
      <p>1次元の一様重力場における質量 $m$ の粒子の運動を考えます。</p>
      <p>運動エネルギー $T$ は、運動量 $p$ を用いて $T = \frac{p^2}{2m}$ と表されます。</p>
      <p>重力によるポテンシャルエネルギー $U(q)$ は、高さ $q$ に比例するので $U(q) = mgq$ となります。</p>
      <p>ハミルトニアン $H$ は、運動エネルギーとポテンシャルエネルギーの和なので:</p>
      <p class="math-eq">$H(q, p) = T + U = \frac{p^2}{2m} + mgq$</p>
      <p>正準方程式を導出します:</p>
      <ol>
        <li>
          $\dot{q} = \frac{\partial H}{\partial p}$
          <p>$H = \frac{p^2}{2m} + mgq$ を $p$ で偏微分すると:</p>
          <p class="math-eq">$\frac{\partial}{\partial p} \left(\frac{p^2}{2m} + mgq\right) = \frac{p}{m}$</p>
          <p>よって、$\dot{q} = \frac{p}{m}$。これも、運動量の定義 $p=m\dot{q}$ を示しています。</p>
        </li>
        <li>
          $\dot{p} = -\frac{\partial H}{\partial q}$
          <p>$H = \frac{p^2}{2m} + mgq$ を $q$ で偏微分すると:</p>
          <p class="math-eq">$\frac{\partial}{\partial q} \left(\frac{p^2}{2m} + mgq\right) = mg$</p>
          <p>
            よって、$\dot{p} = -mg$。これは、粒子の運動量の時間変化が一定の力（重力
            $-mg$）であることを示しており、ニュートンの運動方程式 $F=ma \implies -mg = m\ddot{q}$ と同じ内容です。
          </p>
        </li>
      </ol>
      <p>次に正準方程式を解き、$q$ を $p$ の関数として表します。</p>
      <p>まず、$\dot{p} = -mg$ を時間 $t$ で積分します。</p>
      <p class="math-eq">$\frac{dp}{dt} = -mg$</p>
      <p class="math-eq">$dp = -mg dt$</p>
      <p class="math-eq">$\int dp = \int -mg dt$</p>
      <p class="math-eq">$p(t) = -mgt + C_1$ （$C_1$ は積分定数で、粒子の初期運動量 $p_0$ にあたります。）</p>
      <p>次に、$\dot{q} = \frac{p}{m}$ に上で求めた $p(t)$ を代入し、再度 $t$ で積分します。</p>
      <p class="math-eq">$\frac{dq}{dt} = \frac{1}{m}(-mgt + C_1) = -gt + \frac{C_1}{m}$</p>
      <p class="math-eq">$dq = \left(-gt + \frac{C_1}{m}\right) dt$</p>
      <p class="math-eq">$\int dq = \int \left(-gt + \frac{C_1}{m}\right) dt$</p>
      <p class="math-eq">
        $q(t) = -\frac{1}{2}gt^2 + \frac{C_1}{m}t + C_2$ （$C_2$ は積分定数で、粒子の初期位置 $q_0$ にあたります。）
      </p>
      <p>
        これで $q(t)$ と $p(t)$ が求まりましたが、目標は $q$ を $p$ の関数として表すことです。そのためには、上記の
        $p(t)$ の式から $t$ を消去し、$q(t)$ の式に代入します。
      </p>
      <p class="math-eq">$p = -mgt + C_1$ より、$mgt = C_1 - p$</p>
      <p class="math-eq">$t = \frac{C_1 - p}{mg}$</p>
      <p>この $t$ を $q(t)$ の式に代入します。</p>
      <p class="math-eq">
        $q(p) = -\frac{1}{2}g \left(\frac{C_1 - p}{mg}\right)^2 + \frac{C_1}{m} \left(\frac{C_1 - p}{mg}\right) + C_2$
      </p>
      <p class="math-eq">
        $q(p) = -\frac{g}{2m^2g^2}(C_1^2 - 2C_1p + p^2) + \frac{C_1^2}{m^2g} - \frac{C_1p}{m^2g} + C_2$
      </p>
      <p class="math-eq">
        $q(p) = -\frac{1}{2m^2g}(C_1^2 - 2C_1p + p^2) + \frac{C_1^2}{m^2g} - \frac{C_1p}{m^2g} + C_2$
      </p>
      <p class="math-eq">
        $q(p) = -\frac{C_1^2}{2m^2g} + \frac{C_1p}{m^2g} - \frac{p^2}{2m^2g} + \frac{C_1^2}{m^2g} - \frac{C_1p}{m^2g} +
        C_2$
      </p>
      <p>整理すると、中間項が打ち消し合い、定数項がまとまります。</p>
      <p class="math-eq">$q(p) = -\frac{p^2}{2m^2g} + \left(\frac{C_1^2}{2m^2g} + C_2\right)$</p>
      <p>ここで、定数項全体を改めて $C_3$ と置くと:</p>
      <p class="math-eq">$q(p) = -\frac{p^2}{2m^2g} + C_3$</p>
      <p>
        この結果は、$q$ が $p$
        の二乗に比例する関係を示しており、放物線軌道の一部を表しています。物理的には、重力場中での粒子の全エネルギー（運動エネルギーと位置エネルギーの和）が保存されることを示唆しています。運動エネルギー
        $\frac{p^2}{2m}$ が増加すると位置エネルギー $mgq$
        が減少し、逆に運動エネルギーが減少すると位置エネルギーが増加するというエネルギー変換の様子を、$q$ と $p$
        の関係として捉えることができます。
      </p>
    </div>

    <h3>10.4 位相空間とエルゴードの定理</h3>
    <p>
      多数の分子からなる気体のような複雑な系を扱う際、個々の分子の運動を一つ一つ追跡することは現実的ではありません。そこで、統計的な手法が必要になります。その基礎となるのが<strong>位相空間</strong>と<strong>エルゴードの定理</strong>という概念です。
    </p>

    <h4>位相空間</h4>
    <p>
      私たちの住む現実の空間（実空間）では、粒子の位置だけを考えます。しかし、粒子の運動を完全に記述するためには、位置だけでなく「どのように動いているか」という情報、つまり運動量も必要です。
    </p>
    <p>
      <strong>位相空間</strong
      >とは、系の状態を記述するために、<strong>すべての粒子の位置座標と運動量座標を独立な変数としてとる仮想的な空間</strong>です。
    </p>
    <ul>
      <li>もし1次元を動く1個の粒子であれば、位置 $q$ と運動量 $p$ の2つの座標でその状態を表します。</li>
      <li>
        もし3次元を動く1個の粒子であれば、位置 $(q_x, q_y, q_z)$ と運動量 $(p_x, p_y, p_z)$
        の計6つの座標で状態を表します。
      </li>
      <li>
        そして、もし $N$ 個の粒子からなる系であれば、各粒子について3つの位置座標と3つの運動量座標が必要なので、合計で
        $6N$ 次元の空間になります。
      </li>
    </ul>
    <p>
      この $6N$
      次元の位相空間における<strong>一点（位相点）が、その瞬間の系の微視的な状態を完全に表します</strong>。時間が経つにつれて、この位相点は位相空間内を軌跡を描きながら移動していきます。
    </p>

    <h4>エルゴードの定理</h4>
    <p>
      複雑な系を扱う統計力学では、ある物理量を「時間平均」で考えるか、「統計集団平均（アンサンブル平均）」で考えるかという問題に直面します。
    </p>
    <ul>
      <li><strong>時間平均</strong>: 実際に系を長時間観測し続け、その物理量の平均値を求めること。</li>
      <li>
        <strong>統計集団平均（アンサンブル平均）</strong>:
        同じ巨視的条件（例えば、同じ温度、同じ体積、同じ粒子数）を持つ、しかし異なる微視的状態にある仮想的な多数の系の集合（統計集団、アンサンブル）を考え、その集合内での物理量の平均値を求めること。
      </li>
    </ul>
    <p>
      エルゴードの定理は、<strong>熱平衡状態にある孤立系において、十分長い時間の平均と、位相空間内の（同じエネルギーを持つ）微視状態全てに対する統計集団平均が等しくなる</strong>という非常に重要な定理です。
    </p>
    <p>
      この定理が意味するのは、実際に膨大な時間待たなくても、統計的な方法で計算された平均値が、現実の系の平均値と一致する、ということです。これは、統計力学の正当性を与えるものであり、熱力学と分子運動論を結びつける上で不可欠な概念となります。
    </p>

    <h3>10.5 等重率の原理</h3>
    <p>
      エルゴードの定理と密接に関連するのが、<strong>等重率の原理（Principle of Equal A Priori Probabilities）</strong
      >です。
    </p>
    <p>
      この原理は、<strong
        >孤立した熱平衡状態にある系では、系のエネルギーがある与えられた値 $E \sim E + \delta E$
        の範囲にある微視状態は、すべて等しい実現確率を持つ</strong
      >というものです。
    </p>
    <p>
      例えば、サイコロを振るとき、それぞれの目（1から6）が出る確率は等しいと仮定します。これと同じように、熱平衡状態にある系の位相空間内で、同じエネルギーを持つすべての可能な微視的状態は、どれも同じくらい起こりやすい、という「前提」を置くことで、統計的な計算を進めることができます。
    </p>
    <p>
      この原理は、多くの統計力学的導出の出発点となり、なぜ特定の分布（ボルツマン分布など）が熱平衡状態に現れるのかを説明する基礎となります。
    </p>

    <h3>10.6 ラグランジュの未定乗数法</h3>
    <p>
      統計力学では、多数の粒子が様々なエネルギー状態をとる中で、ある特定の「条件」（例えば、粒子の総数が一定である、系の全エネルギーが一定である、など）を満たしながら、最も確率の高い（またはエントロピーが最大となる）粒子のエネルギー分布を求める、という問題によく遭遇します。
    </p>
    <p>
      このような「<strong>拘束条件（制約条件）の下で、ある関数を最大化（または最小化）する</strong>」という数学的な問題を解く際に非常に強力なツールとなるのが、<strong>ラグランジュの未定乗数法</strong>です。
    </p>
    <p>
      具体的な適用例として、変数 $x, y$ の関数 $f(x, y)$ を、拘束条件 $g(x, y) = c$
      のもとで最大化（または最小化）する問題を考えます。このとき、新しい変数
      $\lambda$（ラグランジュ乗数）を導入し、補助関数（ラグランジアン）$L(x, y, \lambda)$ を定義します。
    </p>
    <p class="math-eq">$L(x, y, \lambda) = f(x, y) - \lambda (g(x, y) - c)$</p>
    <p>
      このラグランジアンを $x, y, \lambda$
      のそれぞれで偏微分し、それらをゼロと置くことで、最適解とラグランジュ乗数を求めることができます。
    </p>
    <p class="math-eq">
      $\frac{\partial L}{\partial x} = \frac{\partial f}{\partial x} - \lambda \frac{\partial g}{\partial x} = 0$
    </p>
    <p class="math-eq">
      $\frac{\partial L}{\partial y} = \frac{\partial f}{\partial y} - \lambda \frac{\partial g}{\partial y} = 0$
    </p>
    <p class="math-eq">$\frac{\partial L}{\partial \lambda} = -(g(x, y) - c) = 0 \implies g(x, y) = c$</p>
    <p>
      これらの連立方程式を解くことで、拘束条件を満たしながら関数 $f$
      を最適化する点を見つけ出します。この方法は、拘束条件を直接扱う代わりに、拘束条件なしの最適化問題に変換することで、多変数関数の微分が容易になり、物理的な問題を数学的に解きほぐす道筋を与えてくれます。統計力学では、ボルツマン分布やフェルミ・ディラック分布、ボース・アインシュタイン分布といった重要な分布関数を導出する際に頻繁に用いられます。
    </p>

    <h2>第11回：カノニカル集団とグランドカノニカル集団</h2>
    <p>
      古典統計力学の破綻と量子論への橋渡し、そして古典力学の別の表現である正準形式と位相空間の概念を学んだところで、いよいよ統計力学の中心概念である「統計集団（アンサンブル）」に入ります。
    </p>
    <p>
      統計集団とは、私たちが知りたい系（例えばコップの中の水分子）と<strong>同じ巨視的な条件を持つ、仮想的な多数の系の集合</strong>のことです。なぜこのような集合を考えるのでしょうか？現実の系は常に時間変化しており、特定の瞬間の微視的状態を正確に知ることは不可能です。そこで、多数の仮想的な系を考えることで、それらの系の平均的な性質を調べることで、現実の系の巨視的な性質を理解しようとするのです。
    </p>
    <p>
      系が外界とどのようにエネルギーや粒子をやり取りするかによって、いくつかの種類の統計集団が考えられます。ここでは特に重要な2つの集団を学びます。
    </p>

    <h3>11.1 カノニカル集団（正準集団）</h3>
    <p>
      <strong>カノニカル集団（Canonical Ensemble）</strong
      >は、以下の条件が一定に保たれた系を記述するために用いられる統計集団です。
    </p>
    <ul>
      <li><strong>粒子数 $N$</strong>: 系を構成する粒子の数が一定です。</li>
      <li><strong>体積 $V$</strong>: 系が占める空間の体積が一定です。</li>
      <li>
        <strong>温度 $T$</strong>: 系は、温度 $T$
        の巨大な熱源（外界）と熱的に接触しており、エネルギーをやり取りすることで、常に同じ温度 $T$ に保たれています。
      </li>
    </ul>
    <p>つまり、カノニカル集団は「<strong>温度が一定に保たれた閉鎖系</strong>」をモデル化します。</p>

    <h4>微視状態の確率 $P_j$</h4>
    <p>
      カノニカル集団では、系が特定の微視状態 $j$ （そのエネルギーを $E_j$ とする）に見出される確率は、そのエネルギー
      $E_j$
      が高いほど小さくなります。これは、より多くのエネルギーを熱源から借りる必要があるためです。この確率は、<strong>ボルツマン因子</strong>と呼ばれる指数関数を用いて以下のように表されます。
    </p>
    <p class="math-eq">$P_j = \frac{\exp(-\frac{E_j}{k_B T})}{Z}$</p>
    <p>ここで、</p>
    <ul>
      <li>$k_B$ はボルツマン定数です。</li>
      <li>$T$ は系の絶対温度です。</li>
      <li>
        $\exp(-\frac{E_j}{k_B T})$ はボルツマン因子と呼ばれ、エネルギー $E_j$
        の状態の相対的な確率の重みを示します。エネルギーが高い状態ほど、この値は小さくなります。
      </li>
      <li>$Z$ は<strong>分配関数</strong>と呼ばれる正規化定数です。</li>
    </ul>

    <h4>分配関数 $Z$ の導入と重要性</h4>
    <p>確率 $P_j$ の分母にある $Z$ は、すべての可能な微視状態 $j$ についてのボルツマン因子の和として定義されます。</p>
    <p class="math-eq">$Z = \Sigma_j \exp(-\frac{E_j}{k_B T})$</p>
    <p>
      もし系が取りうるエネルギー状態が連続的である場合は、状態密度 $\Omega(E)$ （エネルギー $E$
      付近の単位エネルギーあたりの微視状態の数）を用いて積分で表されます。
    </p>
    <p class="math-eq">$Z = \int \Omega(E) \exp(-\frac{E}{k_B T}) dE$</p>
    <p class="important-point">
      この<strong>分配関数 $Z$ は、カノニカル集団において最も重要な物理量</strong
      >です。なぜなら、一度分配関数が計算できれば、その系に関する<strong
        >すべての巨視的な熱力学量（内部エネルギー、エントロピー、自由エネルギー、圧力、比熱など）を、この $Z$
        から導出できる</strong
      >からです。分配関数は、系が持ちうるエネルギー状態の「分配」の仕方を総合的に表しており、その系の「統計的な情報」を全て含んでいると言えます。
    </p>

    <h4>分配関数の計算例：識別可能な2準位系</h4>
    <p>具体的な例で分配関数を計算してみましょう。</p>
    <p>
      $N$
      個の識別可能な粒子からなる系を考えます（例えば、結晶格子点に固定された原子）。各粒子は、エネルギー0の状態と、エネルギー
      $\epsilon$ の状態の2つの準位のみを取ることができるとします。
    </p>
    <p>
      もし $k$ 個の粒子がエネルギー $\epsilon$ の状態にあり、残りの $N-k$
      個の粒子がエネルギー0の状態にある場合、系の全エネルギーは $E = k\epsilon$ となります。
    </p>
    <p>このような微視状態の数 $n(k\epsilon)$ は、 $N$ 個の粒子の中から $k$ 個を選ぶ組み合わせの数で与えられます。</p>
    <p class="math-eq">$n(k\epsilon) = \binom{N}{k} = \frac{N!}{k!(N-k)!}$</p>
    <p>
      この場合の分配関数 $Z$ は、取りうるすべての $k$ （$0$ から $N$
      まで）について、それぞれの状態数にボルツマン因子を掛けたものを足し合わせた和で表されます。
    </p>
    <p class="math-eq">$Z = \Sigma_{k=0}^{N} \frac{N!}{k!(N-k)!} \exp(-\frac{k\epsilon}{k_B T})$</p>
    <p>ここで、二項定理 $(a+b)^N = \Sigma_{k=0}^{N} \frac{N!}{k!(N-k)!} a^{N-k}b^k$ を思い出してください。</p>
    <p>上記の分配関数の式は、この二項定理の形にぴったり当てはまります。</p>
    <p>$a = 1$, $b = \exp(-\frac{\epsilon}{k_B T})$ と置くと、</p>
    <p class="math-eq">$Z = (1 + \exp(-\frac{\epsilon}{k_B T}))^N$</p>
    <p>
      ここで、括弧の中身 $Z_1 = (1 + \exp(-\frac{\epsilon}{k_B T}))$ は、<strong>一粒子の分配関数</strong>と呼ばれます。
    </p>
    <p>したがって、この系の分配関数は、一粒子の分配関数を使って非常に簡潔に表すことができます。</p>
    <p class="math-eq">$Z = Z_1^N$</p>
    <p>
      この結果は、識別可能な独立な粒子からなる系の全分配関数が、個々の一粒子の分配関数の積（この場合は $N$
      乗）で表せるという、重要な性質を示しています。
    </p>

    <h4>内部エネルギー $E$</h4>
    <p>
      分配関数 $Z$ から、系の平均内部エネルギー $E$
      を計算することができます。内部エネルギーは、系が持つ平均的なエネルギーを表します。
    </p>
    <p class="math-eq">$E = \langle E \rangle_{can} = -\frac{\partial}{\partial(\frac{1}{k_B T})} \ln Z$</p>
    <p>または、温度 $T$ で微分する形でも書けます。</p>
    <p class="math-eq">$E = k_B T^2 \frac{\partial \ln Z}{\partial T}$</p>
    <p>
      この式は、分配関数が温度にどのように依存するかを知ることで、系の内部エネルギーを計算できることを示しています。
    </p>

    <h4>ヘルムホルツの自由エネルギー $F$ と圧力 $P$</h4>
    <p>
      熱力学には、様々な「自由エネルギー」と呼ばれる物理量があります。これらは、特定の条件下で系が外界に対してなしうる仕事の最大値を示し、化学反応の方向性や相転移などを議論する上で非常に重要です。
    </p>
    <p>
      カノニカル集団と密接に関連するのが、<strong>ヘルムホルツの自由エネルギー $F$</strong>
      です。ヘルムホルツの自由エネルギーは、以下の単純な関係で分配関数 $Z$ と結びついています。
    </p>
    <p class="math-eq">$F = -k_B T \ln Z$</p>
    <p>
      この関係式は非常に強力です。なぜなら、分配関数さえ計算できれば、そこからヘルムホルツの自由エネルギーが直接得られ、さらにこの自由エネルギーから他の多くの熱力学量（例えば圧力
      $P$ やエントロピー
      $S$）を導出できるからです。分配関数は、系が持ちうるエネルギー状態の「分配」の仕方を総合的に表しており、その系の「統計的な情報」を全て含んでいると言えます。
    </p>
    <p>例えば、圧力 $P$ はヘルムホルツの自由エネルギーを体積 $V$ で偏微分することで得られます。</p>
    <p class="math-eq">$P = - \left(\frac{\partial F}{\partial V}\right)_T$</p>
    <p>上記の $F$ の式を代入すると:</p>
    <p class="math-eq">
      $P = - \frac{\partial}{\partial V} (-k_B T \ln Z)_T = k_B T \left(\frac{\partial \ln Z}{\partial V}\right)_T$
    </p>
    <p>この式は、分配関数が体積にどのように依存するかを知ることで、系の圧力を計算できることを示しています。</p>

    <div class="exercise">
      <h4>演習問題 11.1</h4>
      <p>
        古典単原子理想気体について、ハミルトニアンが $H = \Sigma_{i=1}^{N} \frac{p_i^2}{2m}$
        で与えられるとき、ヘルムホルツの自由エネルギー $F$ を導出し、その結果を用いて圧力 $P$ を求めよ。
      </p>
    </div>
    <div class="solution">
      <h4>解答 11.1</h4>
      <p>
        古典単原子理想気体は、相互作用しない $N$
        個の同一の粒子から構成されます。それぞれの粒子の運動は独立であり、全体のハミルトニアンは各粒子の運動エネルギーの和で与えられます。
      </p>
      <p class="math-eq">$H = \Sigma_{i=1}^{N} \frac{p_i^2}{2m}$ （ただし、体積 $V$ の容器に閉じ込められています。）</p>
      <p>
        まず、1粒子の状態和（分配関数に相当する古典的な表現） $z$
        を計算します。これは、1粒子がとりうる位相空間内の状態を積分したものです。古典論では、位置と運動量の位相空間体積
        $h^3$ を1つの状態に対応させます。（$h$ はプランク定数、古典論では概念的に導入されます）。
      </p>
      <p class="math-eq">
        $z = \frac{1}{h^3} \int_{V} d^3q \int_{-\infty}^{\infty} d^3p \exp\left(-\frac{p^2}{2mk_BT}\right)$
      </p>
      <p>位置の積分 $\int_{V} d^3q$ は、容器の体積 $V$ となります。</p>
      <p>
        運動量の積分 $\int_{-\infty}^{\infty} d^3p \exp\left(-\frac{p^2}{2mk_BT}\right)$
        は、3つのガウス積分の積になります。
      </p>
      <p class="math-eq">
        $\int_{-\infty}^{\infty} \exp(-ax^2)dx = \sqrt{\frac{\pi}{a}}$ を利用し、$a = \frac{1}{2mk_BT}$ とすると、
      </p>
      <p class="math-eq">$\int_{-\infty}^{\infty} \exp\left(-\frac{p_x^2}{2mk_BT}\right) dp_x = \sqrt{2\pi m k_B T}$</p>
      <p>これが3次元分あるので、$(2\pi m k_B T)^{3/2}$ となります。</p>
      <p>したがって、1粒子の状態和 $z$ は:</p>
      <p class="math-eq">$z = \frac{V}{h^3} (2\pi m k_B T)^{3/2}$</p>
      <p>
        次に、N個の<strong>識別できない</strong>粒子（理想気体は同種粒子であり、量子論的には区別できない性質を持つため、古典統計でも同様の補正が必要）からなる系の分配関数
        $Z$
        を計算します。識別できない粒子の場合は、各粒子の分配関数を掛け合わせたものを、粒子の入れ替えによって生じる重複を避けるために
        $N!$ で割る必要があります。
      </p>
      <p class="math-eq">$Z = \frac{z^N}{N!} = \frac{1}{N!} \left( \frac{V}{h^3} (2\pi m k_B T)^{3/2} \right)^N$</p>
      <p>ヘルムホルツの自由エネルギー $F = -k_B T \ln Z$ なので:</p>
      <p class="math-eq">
        $F = -k_B T \ln \left[ \frac{1}{N!} \left( \frac{V}{h^3} (2\pi m k_B T)^{3/2} \right)^N \right]$
      </p>
      <p>対数の性質 $\ln(AB) = \ln A + \ln B$ と $\ln(A^B) = B \ln A$ を用いて展開します。</p>
      <p class="math-eq">
        $F = -k_B T \left[ N \ln \left( \frac{V}{h^3} (2\pi m k_B T)^{3/2} \right) - \ln(N!) \right]$
      </p>
      <p>
        ここで、大きな $N$ に対しては<strong>スターリングの近似（Stirling's approximation）</strong> $\ln(N!) \approx N
        \ln N - N$ を用いることができます。
      </p>
      <p class="math-eq">
        $F \approx -k_B T \left[ N \ln \left( \frac{V}{h^3} (2\pi m k_B T)^{3/2} \right) - (N \ln N - N) \right]$
      </p>
      <p class="math-eq">$F = -k_B T N \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) + 1 \right]$</p>
      <p>
        この式は、<strong>ザッカー・テトロードの式</strong>として知られる古典理想気体のヘルムホルツ自由エネルギーの式です。
      </p>
      <p>次に、このヘルムホルツの自由エネルギー $F$ を用いて圧力 $P$ を求めます。</p>
      <p class="math-eq">$P = -\left(\frac{\partial F}{\partial V}\right)_T$</p>
      <p>上記の $F$ の式を体積 $V$ で偏微分します。</p>
      <p class="math-eq">
        $P = -\frac{\partial}{\partial V} \left( -k_B T N \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right)
        + 1 \right] \right)_T$
      </p>
      <p class="math-eq">
        $P = k_B T N \frac{\partial}{\partial V} \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right)
        \right]_T$
      </p>
      <p>ここで、$\ln(定数 \cdot V) = \ln(定数) + \ln V$ なので、$V$ で微分すると $\frac{1}{V}$ となります。</p>
      <p class="math-eq">
        $\frac{\partial}{\partial V} \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) = \frac{1}{V}$
      </p>
      <p>したがって、圧力 $P$ は:</p>
      <p class="math-eq">$P = k_B T N \frac{1}{V} = \frac{Nk_B T}{V}$</p>
      <p>
        この結果は、<strong>理想気体の状態方程式 $PV=Nk_B T$</strong> と完全に一致します（$N$ は分子数、 $Nk_B = R$
        は気体定数）。統計力学から、巨視的な物理法則が導出できることを示しており、非常に美しい結果と言えます。
      </p>
    </div>

    <div class="exercise">
      <h4>レポート問題 11.1</h4>
      <p>
        古典単原子理想気体について、ヘルムホルツの自由エネルギー $F$ を導出し、その結果を用いてエントロピー $S$
        を求めよ。スターリングの公式（$N! \approx N^N e^{-N}$）を用いて階乗は消すこと。
      </p>
    </div>
    <div class="solution">
      <h4>解答 11.1</h4>
      <p>
        上記の演習問題11.1の解答で導出したヘルムホルツの自由エネルギーの式 $F = -k_B T N \left[ \ln \left( \frac{V}{N
        h^3} (2\pi m k_B T)^{3/2} \right) + 1 \right]$ を使用します。
      </p>
      <p>エントロピー $S$ は、ヘルムホルツの自由エネルギー $F$ を温度 $T$ で偏微分することで得られます。</p>
      <p class="math-eq">$S = -\left(\frac{\partial F}{\partial T}\right)_V$</p>
      <p class="math-eq">$F = -k_B N T \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) + 1 \right]$</p>
      <p>
        ここで、$\ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right)$ の部分を $X$ と置くと、$F = -k_B N T (X+1)$
        と書けます。
      </p>
      <p class="math-eq">$X = \ln V - \ln N - 3\ln h + \frac{3}{2}\ln(2\pi m k_B) + \frac{3}{2}\ln T$</p>
      <p>$F$ を $T$ で偏微分する際には、積の微分法を用います。</p>
      <p class="math-eq">
        $\frac{\partial}{\partial T} (T \cdot (X+1)) = 1 \cdot (X+1) + T \cdot \frac{\partial}{\partial T}(X+1)$
      </p>
      <p>まず $\frac{\partial}{\partial T}(X+1)$ を計算します。</p>
      <p class="math-eq">$X+1 = \ln V - \ln N - 3\ln h + \frac{3}{2}\ln(2\pi m k_B) + \frac{3}{2}\ln T + 1$</p>
      <p>この中で $T$ に依存するのは $\frac{3}{2}\ln T$ の項のみなので、</p>
      <p class="math-eq">$\frac{\partial}{\partial T}(X+1) = \frac{3}{2} \cdot \frac{1}{T}$</p>
      <p>したがって、</p>
      <p class="math-eq">
        $\frac{\partial F}{\partial T} = -k_B N \left[ \left( \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) +
        1 \right) + T \cdot \frac{3}{2T} \right]$
      </p>
      <p class="math-eq">
        $\frac{\partial F}{\partial T} = -k_B N \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) + 1 +
        \frac{3}{2} \right]$
      </p>
      <p class="math-eq">
        $\frac{\partial F}{\partial T} = -k_B N \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) +
        \frac{5}{2} \right]$
      </p>
      <p>エントロピー $S = -\frac{\partial F}{\partial T}$ なので、符号を反転させて、</p>
      <p class="math-eq">
        $S = k_B N \left[ \ln \left( \frac{V}{N h^3} (2\pi m k_B T)^{3/2} \right) + \frac{5}{2} \right]$
      </p>
      <p>
        この式は、<strong>ザッカー・テトロードの式（Sackur-Tetrode equation）</strong
        >として知られる、古典理想単原子気体のエントロピーの式と完全に一致します。この式は、理想気体のエントロピーが体積や温度、質量にどのように依存するかを示しており、古典統計力学の重要な成果の一つです。
      </p>
    </div>

    <h3>11.2 グランドカノニカル集団（大正準集団）</h3>
    <p>
      カノニカル集団が「粒子数一定」の系を扱ったのに対し、<strong
        >グランドカノニカル集団（Grand Canonical Ensemble）</strong
      >は、<strong>系と外界の間で粒子をやり取りできる系</strong>を記述するために用いられます。
    </p>
    <p>以下の条件が一定に保たれた系をモデル化します。</p>
    <ul>
      <li>
        <strong>化学ポテンシャル $\mu$</strong>:
        系と外界の間で粒子をやり取りする際のエネルギーのバランスを表す量です。これが一定に保たれているということは、系が粒子を吸収・放出できる
        reservoir（貯蔵庫）と接続されている状態を意味します。
      </li>
      <li><strong>体積 $V$</strong>: 系が占める空間の体積が一定です。</li>
      <li><strong>温度 $T$</strong>: 系は、温度 $T$ の熱源と熱的に接触しており、エネルギーをやり取りします。</li>
    </ul>
    <p>
      つまり、グランドカノニカル集団は「<strong>温度と化学ポテンシャルが一定に保たれた開放系</strong>」をモデル化します。熱源だけでなく、粒子を供給・吸収する粒子源とも接続されているイメージです。
    </p>

    <h4>大分配関数 $\Xi$ の導入と重要性</h4>
    <p>
      グランドカノニカル集団における最も重要な物理量は、<strong>大分配関数 $\Xi$（ギリシャ文字の「クシー」）</strong
      >です。
    </p>
    <p>
      カノニカル集団の分配関数 $Z$ が、固定された粒子数 $N$ のもとでのエネルギー状態の和であったのに対し、大分配関数
      $\Xi$ は、<strong
        >あらゆる粒子数 $N$ の可能性を考慮に入れた上で、すべての微視状態に対するボルツマン因子の和</strong
      >として定義されます。
    </p>
    <p class="math-eq">$\Xi = \Sigma_N \Sigma_j \exp(-\frac{E_j(N) - \mu N}{k_B T})$</p>
    <p>ここで、</p>
    <ul>
      <li>$\Sigma_N$ は、系が持ちうるすべての粒子数 $N$ についての和です（$N=0, 1, 2, \dots$）。</li>
      <li>$\Sigma_j$ は、特定の粒子数 $N$ のもとで、系がとりうるすべての微視状態 $j$ についての和です。</li>
      <li>$E_j(N)$ は、粒子数 $N$ の系の $j$ 番目の微視状態のエネルギーです。</li>
      <li>$\mu$ は化学ポテンシャルで、粒子をやり取りする際のエネルギーの交換を調整します。</li>
    </ul>
    <p>
      大分配関数 $\Xi$
      もまた、その系に関するすべての巨視的な熱力学量（平均粒子数、グランドポテンシャルなど）を導出するための出発点となります。特に、量子統計力学（フェルミ統計やボース統計）では、粒子の数が固定されていない系を扱うことが多いため、このグランドカノニカル集団が非常に有用なツールとなります。
    </p>

    <h2>第12回：古典統計力学の応用と理想量子系の統計力学</h2>

    <h3>12.1 古典統計力学の応用：結晶の格子比熱</h3>
    <p>
      古典統計力学が低温で破綻することを見てきましたが、高温では非常にうまく機能する例として、結晶の格子比熱を考えてみましょう。
    </p>

    <h4>結晶の格子振動モデル</h4>
    <p>
      結晶は、原子が規則正しく並んだ格子構造を持っています。各原子は格子点にしっかりと固定されているように見えますが、実際には熱によって格子点の周りでわずかに振動しています。この原子の振動を「<strong>格子振動</strong>」と呼びます。
    </p>
    <p>
      古典統計力学では、この結晶格子中の $N$
      個の原子を、それぞれ独立した<strong>調和振動子</strong>としてモデル化します。3次元空間の各原子は、X、Y、Z方向の3つの独立な振動モードを持つと考えるので、全体として
      $3N$ 個の独立な1次元調和振動子が存在するとみなせます。
    </p>

    <h4>ハミルトニアン</h4>
    <p>一つの1次元調和振動子のハミルトニアンは、運動エネルギー項とポテンシャルエネルギー項の和で表されます。</p>
    <p class="math-eq">$H_{osc} = \frac{p^2}{2m} + \frac{1}{2}m\omega^2q^2$</p>
    <p>ここで、$m$ は粒子の質量、$p$ は運動量、$q$ は位置（平衡位置からの変位）、$\omega$ は振動の角振動数です。</p>
    <p>
      したがって、$3N$
      個の独立な調和振動子からなる系の全体のハミルトニアンは、これらの各振動子のハミルトニアンの和として表されます。
    </p>
    <p class="math-eq">
      $H = \Sigma_{\mu=1}^{3N} \left(\frac{1}{2m}p_{\mu}^{2} + \frac{1}{2}m\omega^{2}q_{\mu}^{2}\right)$
    </p>
    <p>ここで $\mu$ は、各振動子（自由度）を区別するためのインデックスです。</p>

    <div class="exercise">
      <h4>演習問題 12.1</h4>
      <p>
        上記のハミルトニアンから分配関数を求めよ。各原子が格子点に局在しているため区別可能で、計算の際には $N!$
        で割らなくて良い。ガウス積分は既知のものとして計算して良い。$\int_{-\infty}^{\infty}\exp(-ax^2)dx=\sqrt{\frac{\pi}{a}}$
      </p>
    </div>
    <div class="solution">
      <h4>解答 12.1</h4>
      <p>
        系の分配関数 $Z$
        は、古典統計力学の定義に基づき、位相空間全体にわたるハミルトニアンのボルツマン因子の積分として与えられます。
      </p>
      <p class="math-eq">
        $Z = \frac{1}{h^{3N}} \int \cdots \int dq_1 \cdots dq_{3N} dp_1 \cdots dp_{3N} \exp\left(-\frac{H}{k_B
        T}\right)$
      </p>
      <p>ここで、$h$ はプランク定数です。</p>
      <p>
        ハミルトニアン $H$ は $3N$ 個の独立な項の和であるため、指数関数 $\exp(-H/k_B T)$
        は、各項の積に分解できます。そして、積分もそれぞれの自由度に対応する積分の積に分解できます。
      </p>
      <p class="math-eq">
        $Z = \frac{1}{h^{3N}} \prod_{\mu=1}^{3N} \left( \int_{-\infty}^{\infty} \exp\left(-\frac{p_{\mu}^2}{2mk_B
        T}\right) dp_{\mu} \cdot \int_{-\infty}^{\infty} \exp\left(-\frac{m\omega^2q_{\mu}^2}{2k_B T}\right) dq_{\mu}
        \right)$
      </p>
      <p>ここで、ガウス積分の公式 $\int_{-\infty}^{\infty}\exp(-ax^2)dx=\sqrt{\frac{\pi}{a}}$ を利用します。</p>
      <p><strong>運動量積分の部分</strong>:</p>
      <p class="math-eq">
        $a = \frac{1}{2mk_B T}$ なので、積分結果は $\sqrt{\frac{\pi}{1/(2mk_B T)}} = \sqrt{2\pi m k_B T}$
      </p>
      <p><strong>位置積分の部分</strong>:</p>
      <p class="math-eq">$a = \frac{m\omega^2}{2k_B T}$ なので、積分結果は $\sqrt{\frac{2\pi k_B T}{m\omega^2}}$</p>
      <p>したがって、各1次元調和振動子（$\mu$ 番目の自由度）の分配関数 $Z_{\mu}$ は:</p>
      <p class="math-eq">
        $Z_{\mu} = \frac{1}{h} \left( \sqrt{2\pi m k_B T} \right) \left( \sqrt{\frac{2\pi k_B T}{m\omega^2}} \right)$
      </p>
      <p class="math-eq">$Z_{\mu} = \frac{1}{h} \frac{2\pi k_B T}{\omega}$</p>
      <p class="math-eq">
        $Z_{\mu} = \frac{k_B T}{h/(2\pi)\omega} = \frac{k_B T}{\hbar\omega}$ （ここで $\hbar = \frac{h}{2\pi}$
        はディラック定数です。）
      </p>
      <p>
        系の原子は識別可能であり、それぞれが独立に振動していると仮定しているため、全体の分配関数 $Z$
        は、各振動子（自由度）の分配関数の積として与えられます。
      </p>
      <p class="math-eq">$Z = \prod_{\mu=1}^{3N} Z_{\mu} = \left(\frac{k_B T}{\hbar\omega}\right)^{3N}$</p>
    </div>

    <h4>ヘルムホルツの自由エネルギー、内部エネルギー、定積熱容量</h4>
    <p>
      分配関数 $Z = \left(\frac{k_B T}{\hbar\omega}\right)^{3N}$
      が得られたので、これから他の熱力学量を計算してみましょう。
    </p>
    <ul>
      <li>
        <strong>ヘルムホルツの自由エネルギー $F$</strong>:
        <p class="math-eq">$F = -k_B T \ln Z = -k_B T \ln \left(\left(\frac{k_B T}{\hbar\omega}\right)^{3N}\right)$</p>
        <p class="math-eq">$F = -3Nk_B T \ln \left(\frac{k_B T}{\hbar\omega}\right)$</p>
      </li>
      <li>
        <strong>内部エネルギー $E$</strong>:
        <p class="math-eq">$E = k_B T^2 \left(\frac{\partial \ln Z}{\partial T}\right)_V$</p>
        <p>まず $\ln Z$ を計算します。</p>
        <p class="math-eq">
          $\ln Z = 3N \ln \left(\frac{k_B T}{\hbar\omega}\right) = 3N (\ln k_B + \ln T - \ln \hbar - \ln \omega)$
        </p>
        <p>これを $T$ で偏微分すると、定数項は消え、$\ln T$ の部分のみが残ります。</p>
        <p class="math-eq">$\frac{\partial \ln Z}{\partial T} = 3N \cdot \frac{1}{T}$</p>
        <p>したがって、内部エネルギー $E$ は:</p>
        <p class="math-eq">$E = k_B T^2 \cdot \frac{3N}{T} = 3Nk_B T$</p>
        <p>
          この結果は、エネルギー等分配の法則と一致しています。$3N$ 個の自由度それぞれに $k_B T$
          （位置エネルギーと運動エネルギーそれぞれに $\frac{1}{2}k_B T$
          が分配されるため）が分配されることを示しています。
        </p>
      </li>
      <li>
        <strong>定積熱容量 $C_V$</strong>:
        <p>定積熱容量 $C_V$ は、内部エネルギー $E$ を温度 $T$ で偏微分することで得られます。</p>
        <p class="math-eq">$C_V = \left(\frac{\partial E}{\partial T}\right)_V$</p>
        <p class="math-eq">$C_V = \frac{\partial}{\partial T} (3Nk_B T) = 3Nk_B$</p>
      </li>
    </ul>
    <p class="important-point">
      この結果は、固体1モルあたり（$N$ をアボガドロ定数 $N_A$ とすると）の定積熱容量が $3N_A k_B = 3R$
      となることを示しており、<strong>デュロン=プティの法則</strong>と一致します。これは高温では実験結果とよく合います。しかし、先にも述べたように、<strong>低温になると固体の比熱は3Rから大きく外れ、ゼロに近づく</strong>という実験結果を古典統計力学では説明できませんでした。この古典論の限界は、格子振動のエネルギーもまた量子化されているという、量子論的な視点が必要であることを示しています。
    </p>

    <h3>12.2 理想量子系の統計力学</h3>
    <p>
      古典統計力学が低温で破綻した問題は、20世紀初頭に量子力学が発展するにつれて解決されました。量子力学は、ミクロな粒子やエネルギーが連続的な値をとるのではなく、<strong>飛び飛びの値（量子化された値）しかとれない</strong>という、それまでの常識を覆す新しい概念を導入しました。
    </p>

    <h4>量子状態と不確定性原理</h4>
    <p>
      古典統計力学では、位相空間内の微視状態を連続的に記述しました。しかし、量子論では、<strong
        >ハイゼンベルクの不確定性原理</strong
      >
      ($\Delta q \Delta p \ge \hbar$)
      により、粒子の位置と運動量を同時に完全に正確に決定することはできません。これは、位相空間が連続的ではなく、<strong
        >最小単位（おおよそ $h^3$ の体積）に「量子化」されている</strong
      >ことを示唆しています。
    </p>

    <h4>同種粒子の不可識別性</h4>
    <p>
      量子論におけるもう一つの重要な概念は、<strong>同種粒子の不可識別性</strong>です。古典論では、同じ種類の粒子であっても、理論上は区別できるとされていました。しかし、量子論では、同じ種類の粒子（例えば、すべての電子やすべての光子）は、根本的に区別できない（<strong
        >identical and indistinguishable</strong
      >）とされます。これは、古典統計力学で $N!$ で割るという「ボルツマンの数え上げの誤り」を自然に解決するものでした。
    </p>

    <h4>粒子の統計性</h4>
    <p>
      同種粒子が量子状態をどのように占めることができるかによって、大きく分けて2種類の「統計性」が生まれます。これは粒子の持つ<strong>スピン</strong>という量子的な性質によって決まります。
    </p>
    <ul>
      <li>
        <strong>ボース・アインシュタイン統計 (BE統計)</strong>:
        <strong>整数スピン</strong
        >を持つ粒子（<strong>ボソン</strong>と呼びます）に従う統計性です。ボソンは、<strong>同一の量子状態に何個でも粒子が入ることができます</strong>。
        例：光子（光の粒子）、フォノン（結晶の格子振動の量子）、ヘリウム4原子など。
        この性質のため、特定の量子状態に多くの粒子が凝縮する「ボース・アインシュタイン凝縮」のような現象が起こりえます。
      </li>
      <li>
        <strong>フェルミ・ディラック統計 (FD統計)</strong>:
        <strong>半整数スピン</strong
        >を持つ粒子（<strong>フェルミオン</strong>と呼びます）に従う統計性です。フェルミオンは、<strong>パウリの排他原理</strong>により、<strong>同一の量子状態には1個の粒子しか入ることができません</strong>。
        例：電子、陽子、中性子など。
        この排他原理が、原子の電子殻構造や、金属の電気伝導性、星の安定性（白色矮星や中性子星の安定性）などを説明する上で非常に重要となります。
      </li>
    </ul>

    <h4>グランドカノニカル集団の利用</h4>
    <p>
      量子統計力学では、各エネルギー準位に何個の粒子が入っているか（占有数）が中心的な役割を果たします。全粒子数 $N$
      を固定して扱うカノニカル集団よりも、粒子数が変化する系に適用できる<strong>グランドカノニカル集団</strong>を用いて議論する方が、数学的に便利であることが多いです。
    </p>
    <p>
      なぜなら、グランドカノニカル集団では、粒子数そのものが変数となり、各量子準位の占有数を直接扱うことができるからです。最終的に平均値を議論する際には、どの統計集団（ミクロカノニカル、カノニカル、グランドカノニカル）を用いても、巨視的な熱力学量の結果は同じになります。
    </p>
    <p>
      これらの量子統計の概念を導入することで、古典統計力学では説明できなかった低温での比熱の振る舞いや、黒体輻射のスペクトルなどが正確に説明できるようになります。
    </p>

    <h2 style="text-align: center">まとめ</h2>
    <p>
      このドキュメントを通じて、熱力学と統計力学の奥深さを探求しました。気体の分子運動論から始まり、古典統計力学が直面した歴史的な困難（低温での比熱問題や紫外破綻）を理解し、それが量子論の必要性をどのように浮き彫りにしたかを見てきました。
    </p>
    <p>
      また、解析力学の強力な形式であるハミルトニアンと正準方程式、多数の粒子の統計的振る舞いを記述するための位相空間とエルゴードの定理、そして熱平衡状態の確率分布の基礎となる等重率の原理を学びました。
    </p>
    <p>
      さらに、系が外界とどのように相互作用するかによって異なる統計集団（カノニカル集団とグランドカノニカル集団）の概念を導入し、それぞれの集団における「分配関数」が、いかに系のすべての熱力学情報を凝縮しているかを理解しました。具体的な計算例を通じて、分配関数から内部エネルギー、自由エネルギー、圧力を導出できることを示しました。
    </p>
    <p>
      最後に、量子統計力学への導入として、同種粒子の不可識別性や、ボソンとフェルミオンの異なる統計性（ボース・アインシュタイン統計とフェルミ・ディラック統計）の重要性を概観しました。これらの概念が、古典統計力学では説明できなかった現象を解決するための鍵となります。
    </p>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [['$','$'], ['\\(','\\)']],
              displayMath: [['$$','$$'], ['\\[','\\]']],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          },
          "HTML-CSS": {
              preferredFont: "TeX",
              availableFonts: ["TeX"],
              linebreaks: { automatic: true },
              EqnChunk: 1,  /* The number of equations to process at a time.  Set to 1 for no chunking. */
          }
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
    </script>
    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>
    <style>
      .has-jax {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
    </style>
  </body>
</html>
